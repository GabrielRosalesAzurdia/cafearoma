{% extends 'base.html' %} {% block title %} Detalle de Tarea # . {{ task_id }}
{% endblock %} {% block content %}
<div class="row">
  <div class="col-12">
    <h1>📋 Detalle de Tarea de Producción #{{ task_id }}</h1>

    <div class="card">
      <div class="card-body">
        {% if status.error %}
        <div class="alert alert-danger">
          <h5>❌ Error</h5>
          <p>{{ status.error }}</p>
        </div>
        {% else %}
        <table class="table table-bordered">
          <tr>
            <th>ID de Tarea</th>
            <td>#{{ status.task.id }}</td>
          </tr>
          <tr>
            <th>Etapa Actual</th>
            <td>
              <span
                class="badge bg-{% if status.task.stage == 'CO' %}success{% else %}warning{% endif %}"
              >
                {{ status.current_stage }}
              </span>
            </td>
          </tr>
          <tr>
            <th>Progreso</th>
            <td>
              <div class="progress" style="height: 25px">
                <div
                  class="progress-bar"
                  role="progressbar"
                  style="width: {{ status.progress }}%;"
                  aria-valuenow="{{ status.progress }}"
                  aria-valuemin="0"
                  aria-valuemax="100"
                >
                  {{ status.progress }}%
                </div>
              </div>
            </td>
          </tr>
          <tr>
            <th>Cantidad Planificada</th>
            <td>{{ status.task.planned_kg }} kg</td>
          </tr>
          <tr>
            <th>Unidad Asignada</th>
            <td>{{ status.task.assigned_unit }}</td>
          </tr>
          <tr>
            <th>Fecha de Inicio</th>
            <td>{{ status.task.created_at }}</td>
          </tr>
          <tr>
            <th>Completada</th>
            <td>
              {% if status.is_complete %}
              <span class="badge bg-success">Sí</span>
              {% else %}
              <span class="badge bg-warning">No</span>
              {% endif %}
            </td>
          </tr>
        </table>

        {% if not status.is_complete %}
        <div class="mt-3">
          <a
            href="{% url 'production:advance_stage' task_id %}"
            class="btn btn-success btn-lg"
          >
            ⏭️ Avanzar a Siguiente Etapa
          </a>
        </div>
        {% endif %} {% endif %}
      </div>
    </div>

    <div class="mt-3">
      <a href="{% url 'production:dashboard' %}" class="btn btn-secondary"
        >← Volver al Dashboard</a
      >
    </div>
  </div>
</div>
{% endblock %}
